🏡 국토교통부 API 연동 개발 가이드
문서 목적: 본 문서는 '국토교통부 아파트 매매 실거래가 상세 자료' API를 연동하는 과정에서 개발팀이 반드시 숙지해야 할 기술적 유의사항과 데이터 처리 규칙을 정의합니다.

1. API 요청(Request) 시 핵심 유의사항
1.1. 필수 파라미터
serviceKey (인증키):

(매우 중요) 발급받은 인증키는 반드시 **URL 인코딩(URL Encode)**된 형태로 전달해야 합니다. 원본 키를 그대로 사용 시 '등록되지 않은 서비스키(30)' 오류가 발생합니다.

이 키는 보안을 위해 클라이언트(브라우저)에 절대 노출되어서는 안 되며, Next.js의 서버 측(API Routes)에서만 환경 변수(process.env.API_KEY)를 통해 호출되어야 합니다.

LAWD_CD (지역코드):

행정표준코드의 법정동코드 10자리 중 앞 5자리를 사용합니다. (예: 서울 종로구 11110)

DEAL_YMD (계약월):

YYYYMM 형식의 6자리 문자열입니다. (예: 202407)

이 API는 월 단위 조회만 가능합니다. '최근 1년'과 같은 기간 조회를 위해서는 서버에서 월별로 12번의 API 호출을 수행하고 그 결과를 취합해야 합니다.

1.2. API 호출 제한 (Rate Limiting)
초당 최대 트랜잭션(TPS): 30회

일일 최대 호출량: 개발 계정의 경우 제한이 있을 수 있습니다. (문서상 명시되지 않았으나 일반적)

대응 방안:

불필요한 API 호출을 최소화해야 합니다. SWR의 캐싱 기능을 적극 활용하여 동일한 요청에 대한 중복 호출을 방지해야 합니다.

특정 기간 데이터 조회 시, 서버 측에서 지연(delay)을 동반한 순차적 요청 로직을 구현하여 순간적인 트래픽 초과를 방지하는 것을 고려해야 합니다.

2. API 응답(Response) 데이터 처리 가이드
2.1. 데이터 형식
API는 XML 형식으로 데이터를 반환합니다. Next.js API Route에서 xml-js 또는 유사한 라이브러리를 사용하여 서비스에서 사용하기 용이한 JSON 형식으로 반드시 변환해야 합니다.

2.2. 데이터 정제 (Data Cleansing & Formatting)
dealAmount (거래금액):

12,000과 같이 콤마(,)가 포함된 문자열로 반환됩니다.

숫자 계산 및 필터링을 위해, 서버에서 콤마를 제거하고 숫자(number) 타입으로 변환해야 합니다. (예: "12,000" -> 12000)

단위는 '만원'입니다.

excluUseAr (전용면적):

숫자(number) 타입이며, 단위는 제곱미터(㎡)입니다.

buildYear (건축년도):

간혹 데이터가 누락되거나 0으로 반환될 수 있습니다. 이 경우, 화면에는 '정보 없음' 또는 '-' 등으로 표시하는 예외 처리가 필요합니다.

공백 및 Trim 처리:

aptNm(단지명) 등 문자열 데이터의 양 끝에 불필요한 공백이 포함될 수 있으므로, 서버에서 trim() 처리를 통해 공백을 제거한 후 클라이언트에 전달하는 것을 권장합니다.

2.3. 주요 식별자 (Identifier)
aptSeq (단지 일련번호):

각 아파트 단지를 구분하는 고유한 ID입니다.

지역코드(5자리)-고유번호 형태로 구성됩니다. (예: 11110-2339)

페이지 라우팅(/complex/[aptSeq]) 및 데이터 조회 시 핵심 키로 사용됩니다.

3. 에러 처리 (Error Handling)
API 가이드에 따르면, 다양한 에러 코드가 존재합니다. (예: 03: 데이터 없음, 22: 서비스 요청 제한 횟수 초과)

서버(API Route)에서는 국토부 API의 resultCode를 확인하여, 성공(00)이 아닐 경우 클라이언트에 500 (Internal Server Error) 상태 코드와 함께 명확한 에러 메시지를 전달해야 합니다.

클라이언트에서는 SWR의 error 상태를 감지하여, 사용자에게 "데이터 조회에 실패했습니다." 와 같은 적절한 UI를 보여주어야 합니다.

이 가이드를 숙지한다면, 우리는 외부 API 연동 과정에서 발생할 수 있는 대부분의 문제를 사전에 방지하고, 안정적이며 신뢰도 높은 서비스를 구축할 수 있을 것입니다.